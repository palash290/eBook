<div class="ct_px_30 pb-5">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="d-flex align-items-center justify-content-between gap-3 flex-wrap mb-4">
                    <h4 class="ct_fs_26 ct_fw_700 mb-0 ct_nunito_font">Manage Chatrooms</h4>
                    <button class="ct_purple_btn" data-bs-toggle="modal" data-bs-target="#ct_new_group_chat">+ New Group
                        Chat</button>
                </div>
                <div class="chat-area">
                    <!-- chatlist -->
                    <div class="chatlist ct_chatroom_chatlist">
                        <div class="d-flex align-items-center justify-content-between gap-2 flex-wrap p-3">
                            <h4 class="ct_fs_16 mb-0 ct_fw_700 ct_nunito_font">Contacts</h4>
                            <h4 class="ct_fs_16 mb-0 ct_fw_700 ct_nunito_font ct_text_op_07">{{participantList.length}}
                            </h4>
                        </div>
                        <div class="modal-dialog-scrollable">
                            <div class="modal-content">
                                <div class="chat-header">
                                    <div class="msg-search">
                                        <input type="text" class="form-control" id="inlineFormInputGroup"
                                            placeholder="Search" aria-label="search" (input)="search($event)">
                                    </div>
                                </div>

                                <div class="modal-body mt-4">
                                    <!-- chat-list -->
                                    @if(participantList.length > 0){
                                    <div class="chat-lists" *ngFor="let item of participantList">
                                        <div class="chat-list">
                                            <a class="d-flex align-items-center"
                                                (click)="getAllmessages(item.id, item.isGroupChat ? item : item.participants[0] )">
                                                <div class="ct_chat_list_grid">
                                                    <div class="position-relative">
                                                        <img class="img-fluid ct_img_w_50"
                                                            [src]="item.isGroupChat ? item.profilePic ? item.profilePic : 'assets/img/profile_logo.jpg' : item.participants[0]?.User?.avatar_url || 'assets/img/profile_logo.jpg'"
                                                            alt="user img">
                                                        @if(item.participants[0]?.User?.isOnline && !item.isGroupChat){
                                                        <span class="active"></span>
                                                        }
                                                    </div>
                                                    <div class="flex-grow-1 ms-3">
                                                        <h3 class="ct_fs_16 ct_fw_600">
                                                            {{ item.isGroupChat ? item.name : item.participants[0]?.User?.fullName || 'Unknown User' }}
                                                        </h3>
                                                        <p class="ct_fs_14 ct_fw_500">
                                                            {{ !item.lastMessage ? 'No messages yet' : item.lastMessage?.content == '' ? 'Sent an attachment' : item.lastMessage?.content }}
                                                        </p>
                                                    </div>
                                                </div>
                                                @if(item.unreadCount > 0){
                                                <div class="ct_caht_msg_notify text-end">
                                                    <span class="ms-auto text-dark"
                                                        style="background-color: #FFCC91;">{{item.unreadCount}}</span>
                                                    <h4 class="ct_notify-time mt-3">{{item.lastMessage?.createdAt |
                                                            date:'HH:mm'}}</h4>
                                                </div>
                                                }
                                            </a>
                                            <!-- <a class="d-flex align-items-center"
                                                    (click)="getAllmessages(item.participants[0]?.chatId, item.participants[0])">
                                                    <div class="position-relative">
                                                        <img class="img-fluid ct_img_w_50"
                                                            [src]="item.participants[0]?.User?.avatar_url || 'assets/img/girl_1.png'"
                                                            alt="user img">
                                                    </div>
                                                    <div class="flex-grow-1 ms-3">
                                                        <h3>{{ item.participants[0]?.User?.fullName || 'Unknown User' }}
                                                        </h3>
                                                        <p class="ct_fs_14 ct_purple_text">
                                                            {{ item.lastMessage?.content || 'No messages yet' }}
                                                        </p>
                                                    </div>
                                                    @if(item.unreadCount > 0){
                                                    <div class="ct_caht_msg_notify text-end">
                                                        <span class="ms-auto text-dark"
                                                            style="background-color: #FFCC91;">{{item.unreadCount}}</span>
                                                        <h4 class="ct_notify-time mt-3">{{item.lastMessage?.createdAt |
                                                            date:'HH:mm'}}</h4>
                                                    </div>
                                                    }
                                                </a> -->
                                        </div>
                                    </div>
                                    }@else {
                                    <span class="mb-0 text-center">No Chats Found</span>
                                    }

                                    <!-- chat-list -->
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- chatlist -->

                    <!-- chatbox -->
                    <div class="chatbox" id="chatbox">
                        <div class="modal-dialog-scrollable">
                            <div class="modal-content ct_chatroom_modal_content">
                                <!-- @if (allMessages.length > 0) { -->
                                <div class="d-block">
                                    <div class="msg-head d-flex align-items-center  gap-3 flex-wrap">
                                        <a (click)="closeChatBox()" class="ct_chat_back_btn">
                                            <i class="fa-solid fa-arrow-left text-dark"></i>
                                        </a>
                                        <div class="ct_grid_56_auto">
                                            <img [src]="userDet?.avatar_url ? userDet?.avatar_url : userDet?.profilePic || 'assets/img/profile_logo.jpg'"
                                                alt="">
                                            <div>
                                                <h4 class="ct_fs_24 ct_fw_700 mb-0 text-capitalize ">
                                                    {{userDet?.fullName ? userDet?.fullName : userDet?.name}}
                                                </h4>
                                                <p class="mb-0">
                                                    <!-- <small class="ct_dot_online"></small> -->
                                                    @if (userDet?.isOnline) {
                                                    <span class="ct_online_text_clr">Online</span>
                                                    }
                                                    <!-- <span class="ct_text_op_07">12:55
                                                        am
                                                    </span> -->
                                                </p>
                                                @if(userDet?.isGroupChat){
                                                <p class="mb-0 ct_text_op_07" data-bs-toggle="modal"
                                                    data-bs-target="#ct_members_list_modal" style="cursor: pointer;">
                                                    {{userDet?.participants.length}}
                                                    members
                                                </p>
                                                }
                                            </div>
                                        </div>
                                        @if(userDet?.isGroupChat){
                                        <div class="d-flex gap-4 align-items-center ms-auto">
                                            <a href="javascript:void(0)" data-bs-toggle="modal"
                                                data-bs-target="#ct_add_members_list_modal">
                                                <svg width="23" height="18" viewBox="0 0 23 18" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M3.375 4.5C3.375 3.30653 3.84911 2.16193 4.69302 1.31802C5.53693 0.474106 6.68153 0 7.875 0C9.06847 0 10.2131 0.474106 11.057 1.31802C11.9009 2.16193 12.375 3.30653 12.375 4.5C12.375 5.69347 11.9009 6.83807 11.057 7.68198C10.2131 8.52589 9.06847 9 7.875 9C6.68153 9 5.53693 8.52589 4.69302 7.68198C3.84911 6.83807 3.375 5.69347 3.375 4.5ZM0 16.9559C0 13.493 2.80547 10.6875 6.26836 10.6875H9.48164C12.9445 10.6875 15.75 13.493 15.75 16.9559C15.75 17.5324 15.2824 18 14.7059 18H1.04414C0.467578 18 0 17.5324 0 16.9559ZM17.7188 10.9688V8.71875H15.4688C15.0012 8.71875 14.625 8.34258 14.625 7.875C14.625 7.40742 15.0012 7.03125 15.4688 7.03125H17.7188V4.78125C17.7188 4.31367 18.0949 3.9375 18.5625 3.9375C19.0301 3.9375 19.4062 4.31367 19.4062 4.78125V7.03125H21.6562C22.1238 7.03125 22.5 7.40742 22.5 7.875C22.5 8.34258 22.1238 8.71875 21.6562 8.71875H19.4062V10.9688C19.4062 11.4363 19.0301 11.8125 18.5625 11.8125C18.0949 11.8125 17.7188 11.4363 17.7188 10.9688Z"
                                                        fill="#4B5563" />
                                                </svg>

                                            </a>
                                            <a href="javascript:void(0)" data-bs-toggle="modal"
                                                data-bs-target="#ct_new_group_chat" (click)="editGroupChat(userDet)">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <g fill="none" stroke="#4b5562" stroke-linecap="round"
                                                        stroke-linejoin="round" stroke-width="2">
                                                        <path stroke-dasharray="20" stroke-dashoffset="20" d="M3 21h18">
                                                            <animate fill="freeze" attributeName="stroke-dashoffset"
                                                                dur="0.2s" values="20;0" />
                                                        </path>
                                                        <path stroke-dasharray="48" stroke-dashoffset="48"
                                                            d="M7 17v-4l10 -10l4 4l-10 10h-4">
                                                            <animate fill="freeze" attributeName="stroke-dashoffset"
                                                                begin="0.2s" dur="0.6s" values="48;0" />
                                                        </path>
                                                        <path stroke-dasharray="8" stroke-dashoffset="8" d="M14 6l4 4">
                                                            <animate fill="freeze" attributeName="stroke-dashoffset"
                                                                begin="0.8s" dur="0.2s" values="8;0" />
                                                        </path>
                                                    </g>
                                                </svg>
                                            </a>
                                            <a href="javascript:void(0)" data-bs-toggle="modal"
                                                data-bs-target="#ct_delete_modal" class="text-danger">
                                                <svg xmlns=" http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <path fill="currentColor" d=" M7.5 1h9v3H22v2h-2.029l-.5 17H4.529l-.5-17H2V4h5.5zm2
                                                        3h5V3h-5zM6.03 6l.441 15h11.058l.441-15zM13 8v11h-2V8z" />
                                                </svg>
                                            </a>
                                        </div>
                                        }
                                    </div>

                                    <div class="modal-body"
                                        [ngClass]="{'et_preview_img_size_scroll' : previewFiles.length > 0}" #scrollMe
                                        [scrollTop]="scrollMe.scrollHeight">
                                        <div class="msg-body">
                                            <ul>
                                                @for (item of allMessages; track $index) {

                                                @if(item.senderAuthorId){
                                                <li style="width: fit-content;margin-left: auto;">
                                                    <div class="repaly">
                                                        @if(item.ChatMessageFiles?.length > 0){
                                                        <div class="d-flex gap-2 flex-wrap">
                                                            <nz-image-group class="d-flex gap-2 flex-wrap">
                                                                @for (file of item.ChatMessageFiles; track $index) {
                                                                <img nz-image [nzSrc]="file.fileName"
                                                                    class="img-fluid m-1">
                                                                }
                                                            </nz-image-group>
                                                        </div>
                                                        }
                                                        <p>{{item.content}}
                                                        </p>
                                                        <span class="time text-white">{{formatDate(item.createdAt)}}
                                                        </span>
                                                    </div>
                                                    <img [src]="userInfo.avatar_url ? userInfo.avatar_url : 'assets/img/profile_logo.jpg'"
                                                        alt="">
                                                </li>
                                                }
                                                @if(item.senderUserId){
                                                <li style="width: fit-content;">
                                                    <img [src]="item?.senderUser?.avatar_url ? item?.senderUser?.avatar_url : 'assets/img/profile_logo.jpg'"
                                                        alt="">
                                                    <div class="sender">
                                                        @if(item.ChatMessageFiles?.length > 0){
                                                        <div class="d-flex gap-2 flex-wrap">
                                                            <nz-image-group class="d-flex gap-2 flex-wrap">
                                                                @for (file of item.ChatMessageFiles; track $index) {
                                                                <img nz-image [nzSrc]="file.fileName" class="img-fluid">
                                                                }
                                                            </nz-image-group>
                                                        </div>
                                                        }
                                                        <p class="ct_fw_600 mb-2">
                                                            {{item.content}}
                                                        </p>
                                                        <span
                                                            class="time ms-auto d-block text-end">{{formatDate(item.createdAt)}}</span>
                                                    </div>
                                                </li>
                                                }
                                                }
                                            </ul>

                                        </div>
                                    </div>

                                    <div class="send-box px-0 position-relative">
                                        <div *ngIf="previewFiles.length > 0" class="preview-container">
                                            <div *ngFor="let file of previewFiles" class="preview">
                                                <img *ngIf="file.type.startsWith('image/')" [src]="file.url"
                                                    alt="File preview" />
                                                <i (click)="removeFile(file)" class="fa fa-minus-circle remove"
                                                    aria-hidden="true"></i>
                                            </div>
                                        </div>
                                        <form action="" class="position-relative m-0">
                                            <label for="upload_chat_img_2" class="ct_upload_paper_click_img">
                                                <input type="file" (change)="onFileChange($event)" multiple
                                                    class="d-none" id="upload_chat_img_2" accept="image/*">
                                                <div>
                                                    <i class="fa-solid fa-paperclip"></i>
                                                </div>
                                            </label>
                                            <textarea type="text" class="form-control et_textarea_hide_scroll"
                                                aria-label="message…" placeholder="Write message…"
                                                [(ngModel)]="newMessage" [ngModelOptions]="{standalone: true}"
                                                (keydown)="onKeyDown($event)"></textarea>

                                            <div class="ct_right_side_send_chat_btns">
                                                @if(uploading){
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                    viewBox="0 0 24 24">
                                                    <path fill="none" stroke="currentColor" stroke-dasharray="16"
                                                        stroke-dashoffset="16" stroke-linecap="round"
                                                        stroke-linejoin="round" stroke-width="2"
                                                        d="M12 3c4.97 0 9 4.03 9 9">
                                                        <animate fill="freeze" attributeName="stroke-dashoffset"
                                                            dur="0.2s" values="16;0" />
                                                        <animateTransform attributeName="transform" dur="1.5s"
                                                            repeatCount="indefinite" type="rotate"
                                                            values="0 12 12;360 12 12" />
                                                    </path>
                                                </svg>
                                                } @else {
                                                <i class="fa fa-paper-plane ct_cursor_pointer"
                                                    (click)="sendMessage()"></i>
                                                }
                                            </div>
                                        </form>
                                    </div>
                                </div>
                                <!-- } @else { -->
                                <!-- when chat is empty then show below content -->
                                <div class="ct_empty_chat_box_content d-none">
                                    <svg width="123" height="123" viewBox="0 0 123 123" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <rect x="0.956267" y="1.3696" width="120.87" height="120.87" rx="60.4348"
                                            fill="#F4F5FA" />
                                        <rect x="0.956267" y="1.3696" width="120.87" height="120.87" rx="60.4348"
                                            stroke="#E1E2E9" stroke-width="0.869565" />
                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                            d="M76.764 77.1737C70.1202 83.8182 60.2823 85.2538 52.2315 81.5305C51.043 81.052 50.0686 80.6653 49.1423 80.6653C46.5621 80.6806 43.3505 83.1824 41.6814 81.5152C40.0122 79.8459 42.516 76.6318 42.516 74.036C42.516 73.1096 42.1446 72.1526 41.6661 70.9618C37.9411 62.9123 39.3787 53.0711 46.0225 46.4288C54.5036 37.9445 68.2828 37.9445 76.764 46.4266C85.2605 54.924 85.2452 68.6916 76.764 77.1737Z"
                                            fill="#BEC0CA" stroke="#8B8D97" stroke-width="1.30435"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                        <path d="M69.9541 62.7022H69.9737" stroke="#8B8D97" stroke-width="1.73913"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                        <path d="M61.2412 62.7022H61.2608" stroke="#8B8D97" stroke-width="1.73913"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                        <path d="M52.5244 62.7022H52.544" stroke="#8B8D97" stroke-width="1.73913"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    <div>
                                        <h4 class="ct_fs_20 ct_fw_600">Messages</h4>
                                        <p>Click on a contact to view messages.</p>
                                        <!-- <div class="">
                                            <a href="#" class="ct_purple_btn d-flex align-items-center gap-2"><svg
                                                    width="20" height="20" viewBox="0 0 20 20" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                                        d="M15.8447 16.039C13.1871 18.6968 9.25198 19.271 6.03167 17.7817C5.55627 17.5903 5.16651 17.4356 4.79598 17.4356C3.7639 17.4417 2.47927 18.4425 1.81162 17.7756C1.14396 17.1079 2.14545 15.8222 2.14545 14.7839C2.14545 14.4133 1.99688 14.0305 1.8055 13.5542C0.315505 10.3344 0.890529 6.39795 3.54805 3.74101C6.94052 0.347298 12.4522 0.347298 15.8447 3.74014C19.2432 7.1391 19.2371 12.6461 15.8447 16.039Z"
                                                        stroke="white" stroke-width="1.30435" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                    <path d="M13.1203 10.2505H13.1281" stroke="white"
                                                        stroke-width="1.73913" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                    <path d="M9.63595 10.2505H9.64377" stroke="white"
                                                        stroke-width="1.73913" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                    <path d="M6.14962 10.2505H6.15745" stroke="white"
                                                        stroke-width="1.73913" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                </svg>
                                                <span> New Message</span></a>
                                        </div> -->
                                    </div>
                                </div>
                                <!-- } -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="view_user" tabindex="-1" aria-labelledby="view_userLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content ">
            <div class="modal-header border-0 ">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body pt-0">
                <div class="ct_user_detail">
                    <h4 class="ct_fs_24 ct_fw_600 text-center ">User Details</h4>
                    <div class="ct_user_img ct_mt_40">
                        <img src="assets/img/avatar.png" alt="">
                    </div>
                    <div class="">
                        <table class="table ct_user_border_0">
                            <tr>
                                <td class="ct_fw_600">Full Name</td>
                                <td>John doe</td>
                            </tr>
                            <tr>
                                <td class="ct_fw_600">Email</td>
                                <td>Johndoegamil.com</td>
                            </tr>
                            <tr>
                                <td class="ct_fw_600">Joined Date</td>
                                <td>07-09-2024</td>
                            </tr>
                            <tr>
                                <td class="ct_fw_600">Phone</td>
                                <td>+1 93072059670</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="ct_logout_modal_post" tabindex="-1" aria-labelledby="ct_delete_postLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header py-0 border-0">
                <button type="button" class="btn-close ct_close" data-bs-dismiss="modal" aria-label="Close"><i
                        class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="modal-body">
                <div class="ct_delete_post_modal">
                    <figure>
                        <div class="ct_delete_post_icon">
                            <i class="fa-solid fa-power-off"></i>
                        </div>
                        <figcaption class="mt-4">
                            <h4 class="ct_fs_18 ct_fw_600">Log Out</h4>
                            <p class="mb-0">Are you sure you want to logout? once you logout you need to login
                                again.</p>
                        </figcaption>
                    </figure>
                    <div class="modal-footer justify-content-center border-0 ct_modal_footer">
                        <button type="button" class="ct_purple_btn ct_outline_blue w-100 ct_fw_600"
                            data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="ct_purple_btn ct_btn_red w-100 ct_fw_600">Log Out</button>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>


<!-- New Group chat S -->
<div class="modal fade" id="ct_new_group_chat" tabindex="-1" aria-labelledby="ct_new_group_chatLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <form [formGroup]="Form">
                <div class="modal-header border-0">
                    <h5 class="modal-title ct_fs_24 ct_fw_600 mb-0" id="ct_new_group_chatLabel">
                        {{groupChatId ? 'Update' : 'Create New'}} Group Chat
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center">
                        <div class="ct_upload_user_profile_img">
                            <img [src]="profilePreview ? profilePreview : 'assets/img/profile_logo.jpg'" alt="">
                            <label for="ct_upload_user_profile2" class="position-relative d-block">
                                <input type="file" class="d-none" id="ct_upload_user_profile2" accept="image/*"
                                    (change)="onProfileChange($event)">
                                <div class="ct_authore_banner_upload_icon_12">
                                    <i class="fa-solid fa-pencil"></i>
                                </div>

                            </label>
                        </div>
                    </div>
                    <div class="form-group mb-3">
                        <label for="" class=" mb-2 ct_fs_16">Group Name</label>
                        <input type="text" class="form-control ct_input bg-white ct_border_radius_10"
                            placeholder="Enter group name" formControlName="chatName">
                        <div *ngIf="Form.get('chatName')?.hasError('required') && Form.get('chatName')?.touched"
                            class="text-danger">
                            <small>Group name is required</small>
                        </div>
                    </div>
                    <div class="form-group mb-3">
                        <label for="" class=" mb-2 ct_fs_16">Description</label>
                        <textarea type="text" class="form-control ct_input bg-white ct_border_radius_10 h-auto" rows="4"
                            placeholder="Enter Description" formControlName="description"></textarea>
                        <div *ngIf="Form.get('description')?.hasError('required') && Form.get('description')?.touched"
                            class="text-danger">
                            <small>Description is required</small>
                        </div>
                        <div *ngIf="Form.get('description')?.hasError('maxlength') && Form.get('description')?.touched"
                            class="text-danger">
                            <small>Maximum 150 characters are allowed</small>
                        </div>
                    </div>
                    @if(!groupChatId){
                    <div class="form-group mb-3" #dropdownContainer>
                        <label for="" class=" mb-2 ct_fs_16">Add Members</label>
                        <!-- <div class="position-relative">
                            <input type="text" class="form-control ct_input bg-white ct_border_radius_10"
                                style="padding-left: 35px;" placeholder="Search User name">
                            <i class="fa-solid fa-search ct_search_icon_left"></i>
                        </div> -->
                        <nz-select class="form-control et_genre_multiselect_1" nzMode="tags"
                            nzPlaceHolder="Select Members" [(ngModel)]="selectedReaders"
                            [nzNotFoundContent]="'No Data Found'" formControlName="receiverIds">
                            @for (option of readers; track option) {
                            <nz-option [nzLabel]="option.fullName" [nzValue]="option.id"></nz-option>
                            }
                        </nz-select>
                        <div *ngIf="Form.get('receiverIds')?.hasError('required') && Form.get('receiverIds')?.touched"
                            class="text-danger">
                            <small>Members are required</small>
                        </div>
                    </div>
                    }
                </div>
                <div class="modal-footer border-0 pt-0">
                    <button #submitModalClose type="button" data-bs-dismiss="modal" class="d-none"></button>
                    <button type=" submit" class="ct_purple_btn"
                        (click)="onSubmit()">{{groupChatId ? 'Update' : 'Create'}}
                        Group</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Group Member S -->

<div class="modal fade modal-lg" id="ct_members_list_modal" tabindex="-1" aria-labelledby="ct_members_list_modalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered ">
        <div class="modal-content" style="min-height: 70vh;">
            <div class="modal-header border-0 p-0">
                <h4 class="ct_fs_18 ct_fw_600 mb-2">Description</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body px-0 pt-0">
                <p>
                    {{userDet?.description}}
                </p>
                <h4 class="ct_fs_18 ct_fw_600 mt-2">Members ({{userDet?.participants?.length}})</h4>
                <div class="chat-lists">
                    <div class="chat-list">
                        @for (item of userDet?.participants; track item) {
                        <a class="d-flex align-items-center">
                            <div class="flex-shrink-0 position-relative"><img alt="user img"
                                    [src]="item.User?.avatar_url ? item.User?.avatar_url : item.Author?.avatar_url ? item.Author?.avatar_url : 'assets/img/profile_logo.jpg'"
                                    class="img-fluid ct_img_w_50">
                                @if(item.User?.isOnline === 1 || item.Author?.isOnline === 1){
                                <span class="active"></span>
                                }
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h3 class="ct_fs_16 ct_fw_600">
                                    {{item.User?.fullName ? item.User?.fullName : item.Author?.fullName}}
                                </h3>
                                <!-- <p class="ct_fs_14">12:55 PM</p> -->
                            </div>
                            @if(!item.authorId){
                            <a (click)="removeMember(item.User)" class="text-danger ct_fw_600">Remove</a>
                            }@else {
                            <a class="text-success ct_fw_600">Admin</a>
                            }
                        </a>
                        }
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
<!-- Group Member E -->

<!--Add Group Member S -->

<div class="modal fade modal-lg" id="ct_add_members_list_modal" tabindex="-1"
    aria-labelledby="ct_add_members_list_modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content" style="min-height: 70vh;">
            <div class="modal-header border-0 pt-0">
                <h4 class="ct_fs_24 ct_fw_600 mb-0">Add Member</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body px-0">
                <div class="chat-header px-3">
                    <div class="msg-search"><input type="text" id="inlineFormInputGroup" placeholder="Search"
                            aria-label="search" class="form-control" (input)="searchMember($event)"></div>
                </div>
                <div class="modal-body ">
                    <div class="chat-lists">
                        <div class="chat-list">
                            @if(readers.length === 0) {
                            <div class="mt-5">
                                <div class="ct_empty_chat_box_content d-flex justify-content-center mb-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24">
                                        <path fill="#6b7280"
                                            d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9A3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42c-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3a3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3a3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.54 5.54 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13zM0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9c-.59.68-.95 1.62-.95 2.65V20zm24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65c2.56.34 4.45 1.51 4.45 2.9z" />
                                    </svg>
                                </div>
                                <div>
                                    <h4 class="ct_fs_20 ct_fw_600 text-center">No User Found</h4>
                                </div>
                            </div>
                            }
                            @for (item of readers; track $index) {
                            @if (!isAdded(item.id)) {
                            <a class="d-flex ct_flex_direction_col justify-content-between align-items-center ">
                                <div class="d-flex">
                                    <div class="flex-shrink-0 position-relative"><img alt="user img"
                                            class="img-fluid ct_img_w_50"
                                            [src]=" item.avatar_url ? item.avatar_url : 'assets/img/profile_logo.jpg'">
                                        @if (item.isOnline) {
                                        <span class="active"></span>
                                        }
                                    </div>
                                    <div class="flex-grow-1 ms-3 d-flex align-items-center">
                                        <h3 class="ct_fs_16 ct_fw_600">
                                            {{item.fullName}}
                                        </h3>
                                        <!-- <p class="ct_fs_14 ct_chat_text_overflow">Last Activity
                                            for</p> -->
                                    </div>
                                </div>
                                <div class="">
                                    <p class="mb-0 add_btn" (click)="AddMember(item)">Add</p>
                                </div>
                            </a>
                            }
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--Add Group Member E -->



<!--Remove Modal -->
<div class="modal fade" id="ct_remove_modal" tabindex="-1" aria-labelledby="ct_remove_modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <h4 class="ct_fs_18 ct_fw_18">Remove User from Group?</h4>
                <p class="ct_text_op_07 mb-0">Are you sure you want to remove <span class="ct_fw_600">Jane Doe</span>
                    from the group?</p>
            </div>
            <div class="modal-footer border-0" style="flex-wrap: nowrap;">
                <button type="button" class="ct_purple_outline_btn w-100" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="ct_purple_btn w-100">Remove</button>
            </div>
        </div>
    </div>
</div>

<!-- Delete Modal -->
<div class="modal fade" id="ct_delete_modal" tabindex="-1" aria-labelledby="ct_delete_modalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center">
                <h4 class="ct_fs_18 ct_fw_18">Delete Group Chat?</h4>
                <p class="ct_text_op_07 mb-0">Are you sure you want to delete this group chat?</p>
            </div>
            <div class="modal-footer border-0" style="flex-wrap: nowrap;">
                <button type="button" class="ct_purple_outline_btn w-100" data-bs-dismiss="modal"
                    #closeDelete>Cancel</button>
                <button type="button" class="ct_purple_btn w-100" (click)="deleteGroupChat()">Delete</button>
            </div>
        </div>
    </div>
</div>